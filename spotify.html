<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->

<html>
	<head>
		<title>Spotify User's Music Analysis</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<style>
			h1 {text-align: center;}
		</style>
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script src='spotify-web-api.js'></script>
		<script>
				function testAuth() {
					var client_id = '2324d4a0a83a4e26b618f73ba2d5cd0b';
					var redirect_uri = 'https://kevinbui2.github.io/spotify';

					//var state = generateRandomString(16);

					//localStorage.setItem(stateKey, state);
					var scope = 'user-library-read user-top-read user-read-currently-playing';

					var url = 'https://accounts.spotify.com/authorize';
					url += '?response_type=token';
					url += '&client_id=' + encodeURIComponent(client_id);
					url += '&scope=' + encodeURIComponent(scope);
					url += '&redirect_uri=' + encodeURIComponent(redirect_uri);
					//url += '&state=' + encodeURIComponent(state);

					//window.open(url);
					window.location.replace(url)
				}
				function testStat() {
					current_url = window.location.href;
					access_token = current_url.split("#access_token=")[1].split("&")[0];
					//document.write(access_token);
					var spotifyApi = new SpotifyWebApi();
					spotifyApi.setAccessToken(access_token);
					
					// Getting User Top Artists Short Term
					spotifyApi.getMyTopArtists(options = {limit: 10, time_range: 'short_term'})
					  .then(function(data) {
					    let topArtistsShortTerm = data.items;
					    //console.log(topArtistsShortTerm);
					  }, function(err) {
					    console.log('Something went wrong!', err);
					  });
					// Getting User Top Artists Medium Term
					spotifyApi.getMyTopArtists(options = {limit: 10, time_range: 'medium_term'})
					  .then(function(data) {
					    let topArtistsMediumTerm = data.items;
					    //console.log(topArtistsMediumTerm);
					  }, function(err) {
					    console.log('Something went wrong!', err);
					  });
					// Getting User Top Artists Long Term
					spotifyApi.getMyTopArtists(options = {limit: 10, time_range: 'long_term'})
					  .then(function(data) {
					    let topArtistsLongTerm = data.items;
					    //console.log(topArtistsLongTerm);
					  }, function(err) {
					    console.log('Something went wrong!', err);
					  });

					 //console.log(topArtistsShortTerm)
					 console.log(topArtistsMediumTerm)
					 console.log(topArtistsLongTerm)
				}
		</script>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<a class="title">Spotify User's Music Analysis</a>
				<nav>
					<ul>
						<li><a href="index.html">Home</a></li>
					</ul>
				</nav>
			</header>
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<section id="main" class="wrapper">
						<div class="inner">
							<h1 class="major">A Glimpse Of Your Spotify Statistics</h1>
							<center>
								<span class="image-center"><img src="images/spotify-icon-green-logo-8.png"  width = "100" height = '100' alt="" /></span>
							</center>
							<center>
								<button onClick="testAuth()">Log In</button>
							</center>
							<!--
							<script>
								function testAuth() {
									var client_id = '2324d4a0a83a4e26b618f73ba2d5cd0b';
									var redirect_uri = 'https://kevinbui2.github.io/spotify';

									//var state = generateRandomString(16);

									//localStorage.setItem(stateKey, state);
									var scope = 'user-library-read user-top-read';

									var url = 'https://accounts.spotify.com/authorize';
									url += '?response_type=token';
									url += '&client_id=' + encodeURIComponent(client_id);
									url += '&scope=' + encodeURIComponent(scope);
									url += '&redirect_uri=' + encodeURIComponent(redirect_uri);
									//url += '&state=' + encodeURIComponent(state);

									//window.open(url);
									window.location.replace(url)
								}
								function testStat() {
									current_url = window.location.href;
									access_token = current_url.split("#access_token=")[1].split("&")[0];
									document.write(access_token);
							</script>
						-->
							<p></p>
							<center>
								<button onClick="testStat()">Generate Statistics</button>
							</center>
							<p></p>
							<center>
								<p>Get a glimpse of your spotify data such as your most listened to tracks and top artists in the short, medium, and long term.</p>
							</center>
						</div>
					</section>

			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>